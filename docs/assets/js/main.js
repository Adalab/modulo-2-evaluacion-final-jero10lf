const filterElement=document.querySelector(".js-inputsearch"),searchElement=document.querySelector(".js-btnsearch"),formElement=document.querySelector(".js-form"),favoritesListElement=document.querySelector(".js-favoritesList"),deletefavElement=document.querySelector(".js-resetBtnfav");let series=[],favorites=[],inputValue="";function getSeriesFromApi(e){fetch("//api.tvmaze.com/search/shows?q="+e).then(e=>e.json()).then(e=>{series=[];for(const t of e)series.push(t.show);renderSeries()})}function handleSearch(){getSeriesFromApi(filterElement.value)}function handleForm(e){e.preventDefault()}function renderSeries(){const e=document.querySelector(".js-seriesList");let t="";for(const e of series){let i;i=-1===favorites.findIndex(t=>t.id===e.id)?"serie":"selected",t+=`<li id ="${e.id}" class="js-serie li__serie ${i} >`,t+=`<h3 class="liTitle">${e.name}</h3>`,null===e.image?t+=`<img class="serie__img" src="https://via.placeholder.com/210x295/ffffff/666666/?text=TV" title="${e.name}" alt="${e.name} cover not available"/>`:t+=`<img class="serie__img" src="${e.image.medium}" title="${e.name}" alt="${e.name}  cover"/>`,t+="</li>"}e.innerHTML=t,listenClickedSeries()}function listenClickedSeries(){const e=document.querySelectorAll(".js-serie");for(const t of e)t.addEventListener("click",addFavorites)}function addFavorites(e){const t=e.currentTarget,i=parseInt(t.id),r=series.find(e=>e.id===i),s=favorites.findIndex(e=>e.id===i);-1===s?favorites.push(r):favorites.splice(s,1),renderSeries(),renderFavorites()}function renderFavorites(){let e="";for(const t of favorites)e+=`<li id ="${t.id}" class="js-serieFav li__fav"  >`,e+=' <div class="fav_content">',e+=`<h3 class="liTitle">${t.name}</h3>`,e+=`<button id ="${t.id}" class="js-deleteIcon faicon ">x</button>`,e+="</li>",null===t.image?e+=`<img class="serie__img" src="https://via.placeholder.com/210x295/ffffff/666666/?text=TV" title="${t.name}" alt="${t.name} cover not available"/>`:e+=`<img class="serie__img" src="${t.image.medium}" title="${t.name}" alt="${t.name}  cover"/>`;setInLocalStorage(),favoritesListElement.innerHTML=e,listenClickedFavorites()}function setInLocalStorage(){const e=JSON.stringify(favorites);localStorage.setItem("favorite",e)}function getFromLocalStorage(){let e=localStorage.getItem("favorite");if(null===e)favorites=[];else{const t=JSON.parse(e);favorites=t,renderFavorites()}}function listenClickedFavorites(){const e=document.querySelectorAll(".js-deleteIcon");for(const t of e)t.addEventListener("click",deleteFav)}function deleteFav(e){const t=e.currentTarget,i=parseInt(t.id),r=favorites.findIndex(e=>e.id===i);favorites.splice(r,1),setInLocalStorage(),renderFavorites(),renderSeries()}function deleteallFav(){favorites=[],setInLocalStorage(),renderFavorites(),renderSeries()}searchElement.addEventListener("click",handleSearch),formElement.addEventListener("submit",handleForm),getFromLocalStorage(),deletefavElement.addEventListener("click",deleteallFav);